(()=>{var __webpack_modules__={647:t=>{t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},504:t=>{function e(t,e,r,n,o,i,c){try{var a=t[i](c),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,o)}t.exports=function(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var c=t.apply(r,n);function a(t){e(c,o,i,a,u,"next",t)}function u(t){e(c,o,i,a,u,"throw",t)}a(void 0)}))}}},372:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},816:t=>{function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}},526:t=>{t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},854:(t,e,r)=>{var n=r(515);function o(e,r,i){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=o=Reflect.get:t.exports=o=function(t,e,r){var o=n(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(r):i.value}},o(e,r,i||e)}t.exports=o},620:t=>{function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},e(r)}t.exports=e},422:(t,e,r)=>{var n=r(276);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}},66:(t,e,r)=>{var n=r(873),o=r(647);t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?o(t):e}},276:t=>{function e(r,n){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(r,n)}t.exports=e},515:(t,e,r)=>{var n=r(620);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t}},873:t=>{function e(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=e=function(t){return typeof t}:t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(r)}t.exports=e},135:(t,e,r)=>{t.exports=r(248)},665:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function parse(){var value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(value.startsWith("="))try{return eval(value.slice(1))}catch(t){return value}return value}__webpack_require__.d(__webpack_exports__,{Q:()=>parse})},248:t=>{var e=function(t){"use strict";var e,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),c=new E(n||[]);return i._invoke=function(t,e,r){var n=f;return function(o,i){if(n===h)throw new Error("Generator is already running");if(n===y){if("throw"===o)throw i;return R()}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var a=x(c,r);if(a){if(a===v)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var u=l(t,e,r);if("normal"===u.type){if(n=r.done?y:p,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=y,r.method="throw",r.arg=u.arg)}}}(t,r,c),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var f="suspendedStart",p="suspendedYield",h="executing",y="completed",v={};function d(){}function b(){}function g(){}var _={};_[i]=function(){return this};var m=Object.getPrototypeOf,w=m&&m(m(D([])));w&&w!==r&&n.call(w,i)&&(_=w);var O=g.prototype=d.prototype=Object.create(_);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,i,c,a){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,c,a)}),(function(t){r("throw",t,c,a)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return r("throw",t,c,a)}))}a(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function x(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=l(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function D(t){if(t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,c=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return c.next=c}}return{next:R}}function R(){return{value:e,done:!0}}return b.prototype=O.constructor=g,g.constructor=b,b.displayName=u(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,a,"GeneratorFunction")),t.prototype=Object.create(O),t},t.awrap=function(t){return{__await:t}},k(j.prototype),j.prototype[c]=function(){return this},t.AsyncIterator=j,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var c=new j(s(e,r,n,o),i);return t.isGeneratorFunction(r)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},k(O),u(O,a,"Generator"),O[i]=function(){return this},O.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=D,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return a.type="throw",a.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],a=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var u=n.call(c,"catchLoc"),s=n.call(c,"finallyLoc");if(u&&s){if(this.prev<c.catchLoc)return o(c.catchLoc,!0);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return o(c.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=t,c.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=__webpack_require__(372),e=__webpack_require__.n(t),r=__webpack_require__(816),n=__webpack_require__.n(r),o=function(){function t(r){e()(this,t),this.$el="string"==typeof r?document.querySelector(r):r}return n()(t,[{key:"html",value:function(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}},{key:"text",value:function(t){return void 0!==t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}},{key:"clear",value:function(){return this.html(""),this}},{key:"on",value:function(t,e){this.$el.addEventListener(t,e)}},{key:"off",value:function(t,e){this.$el.removeEventListener(t,e)}},{key:"find",value:function(t){return i(this.$el.querySelector(t))}},{key:"append",value:function(e){return e instanceof t&&(e=e.$el),Element.prototype.append?this.$el.append(e):this.$el.appendChild(e),this}},{key:"closest",value:function(t){return i(this.$el.closest(t))}},{key:"getCoords",value:function(){return this.$el.getBoundingClientRect()}},{key:"findAll",value:function(t){return this.$el.querySelectorAll(t)}},{key:"css",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach((function(r){t.$el.style[r]=e[r]}))}},{key:"getStyles",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,r){return e[r]=t.$el.style[r],e}),{})}},{key:"id",value:function(t){if(t){var e=this.id().split(":");return{row:+e[0],col:+e[1]}}return this.data.id}},{key:"focus",value:function(){return this.$el.focus(),this}},{key:"attr",value:function(t,e){return e?(this.$el.setAttribute(t,e),this):this.$el.getAttribute(t)}},{key:"addClass",value:function(t){return this.$el.classList.add(t),this}},{key:"removeClass",value:function(t){return this.$el.classList.remove(t),this}},{key:"clear",value:function(){return this.html(""),this}},{key:"data",get:function(){return this.$el.dataset}}]),t}();function i(t){return new o(t)}i.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=document.createElement(t);return e&&r.classList.add(e),i(r)};var c=function(){function t(){e()(this,t)}return n()(t,null,[{key:"navigate",value:function(t){window.location.hash=t}},{key:"path",get:function(){return window.location.hash.slice(1)}},{key:"param",get:function(){return t.path.split("/")[1]}}]),t}(),a=function(){function t(r,n){if(e()(this,t),!r)throw new Error("Selector is not provided in Router");this.$placeholder=i(r),this.routes=n,this.page=null,this.changePageHandler=this.changePageHandler.bind(this),this.init()}return n()(t,[{key:"init",value:function(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()}},{key:"changePageHandler",value:function(){this.page&&this.page.destroy(),this.$placeholder.clear();var t=c.path.includes("excel")?this.routes.excel:this.routes.dashboard;this.page=new t(c.param),this.$placeholder.append(this.page.getRoot()),this.page.afterRender()}},{key:"destroy",value:function(){window.removeEventListener("hashchange",this.changePageHandler)}}]),t}(),u=__webpack_require__(422),s=__webpack_require__.n(u),l=__webpack_require__(66),f=__webpack_require__.n(l),p=__webpack_require__(620),h=__webpack_require__.n(p),y=function(){function t(r){e()(this,t),this.params=r}return n()(t,[{key:"getRoot",value:function(){throw new Error('Method "getRoot" should be implemented')}},{key:"afterRender",value:function(){}},{key:"destroy",value:function(){}}]),t}(),v=__webpack_require__(873),d=__webpack_require__.n(v),b={textAlign:"left",fontWeight:"normal",textDecoration:"none",fontStyle:"normal"},g="Новая таблица";function _(t,e){if(t>e){var r=[t,e];e=r[0],t=r[1]}return new Array(e-t+1).fill("").map((function(e,r){return t+r}))}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function w(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t[0].toLowerCase())}))}function O(t,e){var r;return function(){for(var n=this,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];var a=function(){clearTimeout(r),t.apply(n,i),t.apply(void 0,i)};clearTimeout(r),r=setTimeout(a,e)}}function k(t){t.preventDefault()}function j(t){var e=m(t),r=t.split(":")[1];return'\n  <li class = "db__record">\n    <a href="#excel/'.concat(r,'">').concat(e.title,"</a>\n        <strong>\n            ").concat(new Date(e.openedDate).toLocaleDateString(),"\n            ").concat(new Date(e.openedDate).toLocaleTimeString(),"\n        </strong>\n  </li>\n  ")}var x=function(t){s()(a,t);var r,o,c=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h()(r);if(o){var n=h()(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f()(this,t)});function a(){return e()(this,a),c.apply(this,arguments)}return n()(a,[{key:"getRoot",value:function(){var t,e=Date.now().toString();return i.create("div","db").html('\n    <div class="db__header">\n            <h1>Панель Управления</h1>\n        </div>\n\n        <div class="db__new">\n            <div class="db__view">\n                <a href = "#excel/'.concat(e,'" class="db__create">\n                    Новая </br> таблица\n                </a>\n            </div>\n\n        </div>\n\n        <div class="db__table db__view">\n            ').concat((t=function(){for(var t=[],e=0;e<localStorage.length;e++){var r=localStorage.key(e);r.includes("excel")&&t.push(r)}return t}()).length?'<div class="db__list-header">\n                <span>Название</span>\n                <span>Дата открытия</span>\n            </div>\n            <ul class="db__list">\n               '.concat(t.map(j).join(""),"\n            </ul>"):"<p>Вы пока не создали ни одной таблицы</p>","\n        </div>\n    "))}}]),a}(y),S=__webpack_require__(526),P=__webpack_require__.n(S);function E(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function D(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?E(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var R="TABLE_RESIZE",L="CHANGE_TEXT",$="APPLY_STYLE",T="CHANGE_STYLES",A="CHANGE_TITLE",N="UPDATE_DATE";function q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function C(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?q(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function I(t,e){var r,n,o;switch(e.type){case R:return n="col"===e.data.type?"colState":"rowState",C(C({},t),{},P()({},n,H(t,n,e)));case L:return n="dataState",C(C({},t),{},{currentText:e.data.value,field:H(t,n,e)});case T:return C(C({},t),{},{currentStyles:e.data});case $:return o=t[n="stylesState"]||{},e.data.ids.forEach((function(t){o[t]=C(C({},o[t]),e.data.value)})),C(C({},t),{},(r={},P()(r,n,o),P()(r,"currentStyles",C(C({},t.currentStyles),e.data.value)),r));case A:return C(C({},t),{},{title:e.data});case N:return C(C({},t),{},{openedDate:(new Date).toJSON()});default:return t}}function H(t,e,r){var n=t[e]||{};return n[r.data.id]=r.data.value,n}function G(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function J(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?G(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var z={title:g,rowState:{},colState:{},dataState:{},stylesState:{},currentText:"",currentStyles:b,openedDate:(new Date).toJSON()};var M=function(){function t(){e()(this,t),this.listeners={}}return n()(t,[{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return!!Array.isArray(this.listeners[t])&&(this.listeners[t].forEach((function(t){t.apply(void 0,r)})),!0)}},{key:"subscribe",value:function(t,e){var r=this;return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),function(){r.listeners[t]=r.listeners[t].filter((function(t){return t!==e}))}}}]),t}(),F=function(){function t(r){e()(this,t),this.store=r,this.sub=null,this.prevState={}}return n()(t,[{key:"subscribeComponents",value:function(t){var e=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(r){Object.keys(r).forEach((function(n){var o,i;o=e.prevState[n],i=r[n],("object"===d()(o)&&"object"===d()(i)?JSON.stringify(o)===JSON.stringify(i):o===i)||t.forEach((function(t){if(t.isWatching(n)){var e=P()({},n,r[n]);t.storeChanged(e)}}))})),e.prevState=e.store.getState()}))}},{key:"unsubscribeFromStore",value:function(){this.sub.unsubscribe()}}]),t}();function W(t){return{type:R,data:t}}var Y=function(){function t(r){e()(this,t),this.components=r.components||[],this.store=r.store,this.emitter=new M,this.subscriber=new F(this.store)}return n()(t,[{key:"getRoot",value:function(){var t=i.create("div","excel"),e={emitter:this.emitter,store:this.store};return this.components=this.components.map((function(r){var n=i.create("div",r.className),o=new r(n,e);return n.html(o.toHTML()),t.append(n),o})),t}},{key:"init",value:function(){document.addEventListener("contextmenu",k),this.store.dispatch({type:N}),this.subscriber.subscribeComponents(this.components),this.components.forEach((function(t){return t.init()}))}},{key:"destroy",value:function(){this.subscriber.unsubscribeFromStore(),this.components.forEach((function(t){return t.destroy()})),document.removeEventListener("contextmenu",k)}}]),t}();function K(t){return"on"+("string"!=typeof(e=t)?"":e.charAt(0).toUpperCase()+e.slice(1));var e}var U=function(t){s()(c,t);var r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h()(r);if(o){var n=h()(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f()(this,t)});function c(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e()(this,c),(r=i.call(this,t,n.listeners)).name=n.name||"",r.emitter=n.emitter,r.subscribe=n.subscribe||[],r.store=n.store,r.unsuscribers=[],r.prepare(),r}return n()(c,[{key:"prepare",value:function(){}},{key:"toHTML",value:function(){return""}},{key:"$emit",value:function(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(e=this.emitter).emit.apply(e,[t].concat(n))}},{key:"$on",value:function(t,e){var r=this.emitter.subscribe(t,e);this.unsuscribers.push(r)}},{key:"$dispatch",value:function(t){this.store.dispatch(t)}},{key:"storeChanged",value:function(){}},{key:"isWatching",value:function(t){return this.subscribe.includes(t)}},{key:"init",value:function(){this.initDomListeners()}},{key:"destroy",value:function(){this.removeDomListeners(),this.unsuscribers.forEach((function(t){return t()}))}}]),c}(function(){function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e()(this,t),!r)throw new Error("No $root provided for DomListener!");this.$root=r,this.listeners=n}return n()(t,[{key:"initDomListeners",value:function(){var t=this;this.listeners.forEach((function(e){var r=K(e),n=t.name;if(!t[r])throw new Error("Method ".concat(r," is not implemented in ").concat(n," Component"));t[r]=t[r].bind(t),t.$root.on(e,t[r])}))}},{key:"css",value:function(){}},{key:"removeDomListeners",value:function(){var t=this;this.listeners.forEach((function(e){var r=K(e);t.$root.off(e,t[r])}))}}]),t}());function Q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var B=function(t){s()(u,t);var r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h()(r);if(o){var n=h()(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f()(this,t)});function u(t,r){return e()(this,u),a.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Header",listeners:["input","click"]},r))}return n()(u,[{key:"prepare",value:function(){this.onInput=O(this.onInput,300)}},{key:"toHTML",value:function(){var t=this.store.getState().title||g;return'\n      <input type="text" class="input" value="'.concat(t,'" />\n\n      <div>\n\n        <div class="button" data-button = "remove">\n          <i class="material-icons" data-button = "remove">delete</i>\n        </div>\n\n        <div class="button" data-button = "exit">\n          <i class="material-icons" data-button = "exit">exit_to_app</i>\n        </div>\n\n      </div>\n    ')}},{key:"onClick",value:function(t){var e=i(t.target);"remove"===e.data.button?confirm("Вы действительно хотите удалить эту таблицу?")&&(localStorage.removeItem("excel:"+c.param),c.navigate("")):"exit"===e.data.button&&c.navigate("")}},{key:"onInput",value:function(t){var e,r=i(t.target);this.$dispatch((e=r.text(),{type:A,data:e}))}}]),u}(U);function X(t){var e='\n    data-type="button"\n    data-value=\''.concat(JSON.stringify(t.value),"'\n  ");return'\n    <div \n      class="button '.concat(t.active?"active":"",'"\n      ').concat(e,'\n    >\n      <i \n        class="material-icons"\n        ').concat(e,"\n      >").concat(t.icon,"</i>\n    </div>\n  ")}function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function tt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}P()(B,"className","excel__header");var et=function(t){s()(a,t);var r,o,c=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h()(r);if(o){var n=h()(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f()(this,t)});function a(t,r){return e()(this,a),c.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?tt(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Toolbar",listeners:["click"],subscribe:["currentStyles"]},r))}return n()(a,[{key:"prepare",value:function(){this.initState(b)}},{key:"toHTML",value:function(){return this.template}},{key:"storeChanged",value:function(t){this.setState(t.currentStyles)}},{key:"onClick",value:function(t){var e=i(t.target);if("button"===e.data.type){var r=JSON.parse(e.data.value);this.$emit("toolbar:applyStyle",r);var n=Object.keys(r)[0];this.setState(P()({},n,r[n]))}}},{key:"template",get:function(){return[{value:{textAlign:"left"},icon:"format_align_left",active:"left"===(t=this.state).textAlign},{value:{textAlign:"center"},icon:"format_align_justify",active:"center"===t.textAlign},{value:{textAlign:"right"},icon:"format_align_right",active:"right"===t.textAlign},{value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"},icon:"format_bold",active:"bold"===t.fontWeight},{value:{textDecoration:"underline"===t.textDecoration?"none":"underline"},icon:"format_underlined",active:"underline"===t.textDecoration},{value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"},icon:"format_italic",active:"italic"===t.fontStyle}].map(X).join("");var t}}]),a}(function(t){s()(c,t);var r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h()(r);if(o){var n=h()(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f()(this,t)});function c(){e()(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return i.call.apply(i,[this].concat(r))}return n()(c,[{key:"initState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=V({},t)}},{key:"setState",value:function(t){this.state=V(V({},this.state),t),this.$root.html(this.template)}},{key:"template",get:function(){return JSON.stringify(this.state,null,2)}}]),c}(U));P()(et,"className","excel__toolbar");var rt=__webpack_require__(854),nt=__webpack_require__.n(rt);function ot(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var it=function(t){s()(a,t);var r,o,c=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h()(r);if(o){var n=h()(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f()(this,t)});function a(t,r){return e()(this,a),c.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ot(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Formula",listeners:["input","keydown"],subscribe:["currentText"]},r))}return n()(a,[{key:"toHTML",value:function(){return'\n      <div class="info">fx</div>\n      <div id="formula" class="input" contenteditable spellcheck="false"></div>\n    '}},{key:"init",value:function(){var t=this;nt()(h()(a.prototype),"init",this).call(this),this.$formula=this.$root.find("#formula"),this.$on("table:select",(function(e){t.$formula.text(e.data.value)}))}},{key:"storeChanged",value:function(t){var e=t.currentText;this.$formula.text(e)}},{key:"onInput",value:function(t){var e=i(t.target).text();this.$emit("formula:input",e)}},{key:"onKeydown",value:function(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.$emit("formula:done"))}}]),a}(U);P()(it,"className","excel__formula");var ct=__webpack_require__(135),at=__webpack_require__.n(ct),ut=__webpack_require__(504),st=__webpack_require__.n(ut),lt=__webpack_require__(665);function ft(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function pt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ft(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ht(t,e){return(t[e]||120)+"px"}function yt(t,e){return(t[e]||24)+"px"}function vt(t,e){return function(r,n){var o="".concat(e,":").concat(n),i=ht(t.colState,n),c=t.dataState[o],a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(b).map((function(e){return"".concat(w(e),": ").concat(t[e])})).join(";")}(pt(pt({},b),t.stylesState[o]));return'\n      <div \n        class="cell" \n        contenteditable \n        data-col="'.concat(n,'"\n        data-type="cell"\n        data-id="').concat(o,'"\n        data-value = "').concat(c||"",' "\n        style="').concat(a,"; width: ").concat(i,'"\n      >').concat((0,lt.Q)(c)||"","</div>\n    ")}}function dt(t){var e=t.col,r=t.index,n=t.width;return'\n    <div \n      class="column" \n      data-type="resizable" \n      data-col="'.concat(r,'" \n      style="width: ').concat(n,'"\n    >\n      ').concat(e,'\n      <div class="col-resize" data-resize="col"></div>\n    </div>\n  ')}function bt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t?'<div class="row-resize" data-resize="row"></div>':"",o=yt(r,t);return'\n    <div \n      class="row" \n      data-type="resizable" \n      data-row="'.concat(t,'"\n      style="height: ').concat(o,'"\n    >\n      <div class="row-info">\n        ').concat(t||"","\n        ").concat(n,'\n      </div>\n      <div class="row-data">').concat(e,"</div>\n    </div>\n  ")}function gt(t,e){return String.fromCharCode(65+e)}function _t(t){return function(e,r){return{col:e,index:r,width:ht(t.colState,r)}}}function mt(t,e){return new Promise((function(r){var n=i(e.target);n.css({opacity:1});var o,c=n.closest('[data-type="resizable"]'),a=c.getCoords(),u=n.data.resize,s="col"===u?"bottom":"right";n.css(P()({opacity:1},s,"-5000px")),document.onmousemove=function(t){if("col"===u){var e=t.pageX-a.right;o=a.width+e,n.css({right:-e+"px"})}else{var r=t.pageY-a.bottom;o=a.height+r,n.css({bottom:-r+"px"})}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,"col"===u?(c.css({width:o+"px"}),t.findAll('[data-col = "'.concat(c.data.col,'"]')).forEach((function(t){return t.style.width=o+"px"}))):c.css({height:o+"px"}),r({value:o,type:u,id:c.data[u]}),n.css({opacity:0,right:0,bottom:0})}}))}var wt=function(){function t(){e()(this,t),this.group=[],this.current=null}return n()(t,[{key:"select",value:function(e){this.clear(),e.focus().addClass(t.className),this.group.push(e),this.current=e}},{key:"clear",value:function(){this.group.forEach((function(e){return e.removeClass(t.className)})),this.group=[]}},{key:"selectGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.clear(),this.group=e,this.group.forEach((function(e){return e.addClass(t.className)}))}},{key:"applyStyle",value:function(t){this.group.forEach((function(e){return e.css(t)}))}},{key:"selectedIds",get:function(){return this.group.map((function(t){return t.id()}))}}]),t}();function Ot(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}P()(wt,"className","selected");var kt=function(t){s()(u,t);var r,o,c,a=(o=u,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h()(o);if(c){var r=h()(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return f()(this,t)});function u(t,r){return e()(this,u),a.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(r),!0).forEach((function(e){P()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ot(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Table",listeners:["mousedown","keydown","input"]},r))}return n()(u,[{key:"toHTML",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=26,n=[],o=new Array(r).fill("").map(gt).map(_t(e)).map(dt).join("");n.push(bt(null,o));for(var i=0;i<t;i++){var c=new Array(r).fill("").map(vt(e,i)).join("");n.push(bt(i+1,c,e.rowState))}return n.join("")}(30,this.store.getState())}},{key:"prepare",value:function(){this.selection=new wt}},{key:"init",value:function(){var t=this;nt()(h()(u.prototype),"init",this).call(this),this.selectCell(this.$root.find('[data-id="0:0"]')),this.$on("formula:input",(function(e){t.selection.current.attr("data-value",e).text((0,lt.Q)(e)),t.updateTextInStore(e)})),this.$on("formula:done",(function(){t.selection.current.focus()})),this.$on("toolbar:applyStyle",(function(e){var r;t.selection.applyStyle(e),t.$dispatch((r={value:e,ids:t.selection.selectedIds},{type:$,data:r}))}))}},{key:"selectCell",value:function(t){this.selection.select(t),this.$emit("table:select",t);var e=t.getStyles(Object.keys(b));this.$dispatch({type:T,data:e})}},{key:"resizeTable",value:(r=st()(at().mark((function t(e){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,mt(this.$root,e);case 3:r=t.sent,this.$dispatch(W(r)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.warn("Resize error",t.t0.message);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return r.apply(this,arguments)})},{key:"onMousedown",value:function(t){var e=this;if(function(t){return t.target.dataset.resize}(t))this.resizeTable(t);else if(function(t){return"cell"===t.target.dataset.type}(t)){var r=i(t.target);if(t.shiftKey){var n=function(t,e){var r=t.id(!0),n=e.id(!0),o=_(n.col,r.col),i=_(n.row,r.row);return o.reduce((function(t,e){return i.forEach((function(r){return t.push("".concat(r,":").concat(e))})),t}),[])}(r,this.selection.current).map((function(t){return e.$root.find('[data-id="'.concat(t,'"]'))}));this.selection.selectGroup(n)}else this.selectCell(r)}}},{key:"onKeydown",value:function(t){var e=t.key;if(["Enter","Tab","ArrowLeft","ArrowRight","ArrowDown","ArrowUp"].includes(e)&&!t.shiftKey){t.preventDefault();var r=this.selection.current.id(!0),n=this.$root.find(function(t,e){var r=e.col,n=e.row;switch(t){case"Enter":case"ArrowDown":n++;break;case"Tab":case"ArrowRight":r++;break;case"ArrowLeft":r=r-1<0?0:r-1;break;case"ArrowUp":n=n-1<0?0:n-1}return'[data-id = "'.concat(n,":").concat(r,'"]')}(e,r));this.selectCell(n)}}},{key:"updateTextInStore",value:function(t){var e;this.$dispatch((e={id:this.selection.current.id(),value:t},{type:L,data:e}))}},{key:"onInput",value:function(t){this.updateTextInStore(i(t.target).text())}}]),u}(U);function jt(t){return"excel:"+t}P()(kt,"className","excel__table"),new a("#app",{dashboard:x,excel:function(t){s()(c,t);var r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h()(r);if(o){var n=h()(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f()(this,t)});function c(){return e()(this,c),i.apply(this,arguments)}return n()(c,[{key:"getRoot",value:function(){var t,e,r=this.params?this.params:Date.now().toString(),n=function(t){var e=t(D({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{type:"__INIT__"}),r=[];return{subscribe:function(t){return r.push(t),{unsubscribe:function(){r=r.filter((function(e){return e!==t}))}}},dispatch:function(n){e=t(e,n),r.forEach((function(t){return t(e)}))},getState:function(){return JSON.parse(JSON.stringify(e))}}}(I,(t=m(jt(r)))?function(t){return J(J({},t),{},{currentStyles:b,currentText:""})}(t):(e=z,JSON.parse(JSON.stringify(e)))),o=O((function(t){m(jt(r),t)}),300);return n.subscribe(o),this.excel=new Y({components:[B,et,it,kt],store:n}),this.excel.getRoot()}},{key:"afterRender",value:function(){this.excel.init()}},{key:"destroy",value:function(){this.excel.destroy()}}]),c}(y)})})()})();